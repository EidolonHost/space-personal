{% extends 'grid.html' %}
{% block title %}Space{% endblock %}
{% block content %}
<h3>VMs</h3>
<table class="table sortable">
    <thead>
    <tr>
        <th>ID</th>
        <th>Name</th>
        <th>RAM</th>
        <th>VCPU</th>
        <th>Disk Size</th>
        <th>Image</th>
        <th>MAC</th>
        <th>IP</th>
        <th>State</th>
        <th>Flags</th>
        <th>Actions</th>
    </tr>
    </thead>
    {% for server in servers %}
    <tr>
        <td>{{ server.id }}</td>
        <td><a href="/edit/{{ server.id }}">{{ server.name }}</a></td>
        <td>{{ server.vcpu }}</td>
        <td>{{ server.ram }}</td>
        <td>{{ server.disk_size }}</td>
        <td>{{ server.image }}</td>
        <td>{{ server.mac_address }}</td>
        <td>0.0.0.0/24</td>
        <td>
        {% if server.state == 1 %}
        <p><span class="label label-success">Running</span></p>
        {% else %}
        <p><span class="label label-danger">Shutdown</span></p>
        {% endif %}
        </td>
        <td>
        {% if server.inconsistent == 1 %}
        <span class="glyphicon glyphicon-exclamation-sign" data-toggle="tooltip" data-placement="right" title="Server is in an inconsistent state"></span>
        {% endif %}
        </td>
        <td>
        {% if server.state == 1 %}
        <a class="btn btn-warning btn-xs" href="/shutdown/{{ server.id }}">Shutdown</a>&nbsp;
        <a class="btn btn-primary btn-xs" href="/console/{{ server.id }}">Console</a>&nbsp;
        {% elif server.state == 0 %}
        <a class="btn btn-success btn-xs" href="/start/{{ server.id }}">Start</a>&nbsp;
        {% endif %}
        <a class="btn btn-danger btn-xs" href="/destroy/{{ server.id }}">Destroy</a></td>
    </tr>
    {% endfor %}
</table>

<h3>Make a New VM</h3>
<form action="/create" method="post">
    <input class="form-control" type="text" name="name" placeholder="VM Name"/><br/>
    <input class="form-control" type="text" name="ram" placeholder="RAM in MB"/><br/>
    <input class="form-control" type="text" name="disk_size" placeholder="Disk Size in GB"/><br/>
    <input class="form-control" type="text" name="vcpu" placeholder="Number of VCPUs"/><br/>
    <select class="form-control" name="image">
        {% for image in images %}
        <option value="{{ image.id }}">{{ image.name }}</option>
        {% endfor %}
    </select><br/>
    <input class="btn btn-success" type="submit" value="Make it"/>
</form>

<h3>Error / Warning Events</h3>
<table class="table sortable">
    <thead>
    <tr>
        <th>Date</th>
        <th>Level</th>
        <th>Message</th>
    </tr>
    </thead>
    {% for event in log %}
    <tr>
        <td>{{ event.date }}</td>
        <td>
        {% if event.level == 1 %}
        <p><span class="label label-primary">Debug</span></p>
        {% elif event.level == 2 %}
        <p><span class="label label-warning">Warning</span></p>
        {% else %}
        <p><span class="label label-danger">Error</span></p>
        {% endif %}
        </td>
        <td>{{ event.message }}</td>
    </tr>
    {% endfor %}
</table>
{% endblock %}
